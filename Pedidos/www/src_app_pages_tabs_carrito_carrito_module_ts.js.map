{"version":3,"file":"src_app_pages_tabs_carrito_carrito_module_ts.js","mappings":"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","sources":["./src/app/pages/tabs/carrito/carrito-routing.module.ts","./src/app/pages/tabs/carrito/carrito.module.ts","./src/app/pages/tabs/carrito/carrito.page.ts"],"sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { CarritoPage } from './carrito.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: CarritoPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class CarritoPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { CarritoPageRoutingModule } from './carrito-routing.module';\n\nimport { CarritoPage } from './carrito.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    CarritoPageRoutingModule\n  ],\n  declarations: [CarritoPage]\n})\nexport class CarritoPageModule {}\n","import { Component, OnInit } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { Preferences } from '@capacitor/preferences';\nimport { AlertController } from '@ionic/angular';\nimport { ServicioService } from 'src/app/services/servicio.service';\n@Component({\n  selector: 'app-carrito',\n  templateUrl: './carrito.page.html',\n  styleUrls: ['./carrito.page.scss'],\n})\nexport class CarritoPage implements OnInit {\n  lista: any[];\n  total: Number = 0;\n  cliente : any ;\n  constructor(private router : Router, private servicio : ServicioService,private alertController: AlertController) { }\n\n  ngOnInit() {\n    Preferences.get({ key: 'carrito' }).then(data => {\n      let d =JSON.parse(data.value);\n      \n      if (d!=null) {\n        this.lista = d.filter(item => item.estado == false)[0].lista;\n        this.sumaTotal()\n      }\n    })\n\n    Preferences.get({ key: 'cliente' }).then(data => {\n      this.cliente = JSON.parse(data.value);\n    })\n  }\n\n  sumaTotal() {\n    this.total = this.lista.map(item => Number(item.cantidad) * Number(item.producto.precio)).reduce((a, b) => a + b, 0)\n  }\n\n\n  cantidad(item, modo) {\n    item.cantidad = modo ? item.cantidad == 1 ? 1 : item.cantidad - 1 : item.cantidad + 1\n    this.actualizarBolsa()\n    this.sumaTotal()\n  }\n\n  eliminar(item) {\n    this.lista = this.lista.filter(i => i.producto.idProducto != item.producto.idProducto)\n    this.actualizarBolsa()\n  }\n\n  actualizarBolsa() {\n    Preferences.get({ key: 'carrito' }).then(data => {\n      let pedidos: any[] = data.value == null ? [] : JSON.parse(data.value);\n      let list = pedidos.length == 0 ? [] : pedidos.filter(item => item.estado == false)[0].lista;\n      let pos = pedidos.indexOf(pedidos.filter(item => item.estado == false)[0]);\n\n      list = this.lista;\n      let pedido = {\n        estado: false,\n        lista: list\n      }\n      if (pos == -1) {\n        pedidos.push(pedido)\n        Preferences.set({ key: 'carrito', value: JSON.stringify(pedidos) })\n      } else {\n        pedidos[pos] = pedido;\n        Preferences.set({ key: 'carrito', value: JSON.stringify(pedidos) })\n      }\n    })\n  }\n\n  guardar(){\n\n    let detalle = this.lista.map(a => {\n      return {\n        \"idProducto\": a.producto.idProducto,\n        \"precio\": Number(a.producto.precio).toFixed(2),\n        \"cantidad\": a.cantidad\n    }\n  });\n\n     let datos ={\n         descripcion : 'pedido app' ,\n         pedido : new Date().toISOString().slice(0,17),\n         entrega : new Date().toISOString().slice(0,17),\n         total : Number(this.total).toFixed(2),\n         estado : 1,\n         idres : 1 ,\n         idcli : this.cliente.idCliente,\n         idop : 12 ,\n         detalle : detalle\n     }\n\n     this.servicio.post('pedido',datos).subscribe(res=>{\n        Preferences.remove({ key: 'carrito' });\n        this.presentAlert()\n     })\n  }\n\n  async presentAlert() {\n    const alert = await this.alertController.create({\n      header: 'EXITO',\n      message: 'Pedido Guardado!',\n      buttons: ['OK'],\n    });\n\n    await alert.present();\n    this.router.navigateByUrl('/tabs', { replaceUrl:true });\n  }\n}\n"],"names":["Component","Router","Preferences","AlertController","ServicioService","CarritoPage","constructor","router","servicio","alertController","ngOnInit","get","key","then","data","d","JSON","parse","value","lista","filter","item","estado","sumaTotal","cliente","total","map","Number","cantidad","producto","precio","reduce","a","b","modo","actualizarBolsa","eliminar","i","idProducto","pedidos","list","length","pos","indexOf","pedido","push","set","stringify","guardar","detalle","toFixed","datos","descripcion","Date","toISOString","slice","entrega","idres","idcli","idCliente","idop","post","subscribe","res","remove","presentAlert","alert","create","header","message","buttons","present","navigateByUrl","replaceUrl","selector","template"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}